<!-- templates/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-based Hearing Asymmetry Screening</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div id="main-frame">
        <!-- Login Screen -->
        <div id="login-screen">
            <h1 class="title">User Information</h1>
            <form id="login-form">
                <label>Name:</label><br>
                <input type="text" id="name" required><br><br>
                
                <label>Surname:</label><br>
                <input type="text" id="surname" required><br><br>
                
                <label>Age Group:</label><br>
                <input type="radio" name="age_group" value="Child" id="age_child">
                <label for="age_child">Child (&lt;18)</label><br>
                <input type="radio" name="age_group" value="Adult" id="age_adult">
                <label for="age_adult">Adult (18–60)</label><br>
                <input type="radio" name="age_group" value="Senior" id="age_senior">
                <label for="age_senior">Senior (60+)</label><br><br>
                
                <label>Gender (optional):</label><br>
                <input type="radio" name="gender" value="Male" id="gender_male">
                <label for="gender_male">Male</label><br>
                <input type="radio" name="gender" value="Female" id="gender_female">
                <label for="gender_female">Female</label><br>
                <input type="radio" name="gender" value="Other" id="gender_other">
                <label for="gender_other">Other</label><br>
                <input type="radio" name="gender" value="Prefer not to say" id="gender_prefer">
                <label for="gender_prefer">Prefer not to say</label><br><br>
                
                <h2>🎧 Headphone Setup</h2>
                <input type="checkbox" id="headphones_correct">
                <label for="headphones_correct">I am wearing the headphones correctly (Left = L, Right = R).</label><br><br>
                
                <label>ANC Mode:</label><br>
                <input type="radio" name="anc_mode" value="ON" id="anc_on">
                <label for="anc_on">ON</label><br>
                <input type="radio" name="anc_mode" value="OFF" id="anc_off">
                <label for="anc_off">OFF</label><br><br>
                
                <h2>📡 Environment & Health</h2>
                <label>Noise Level Rating (How quiet is your environment?):</label><br>
                <input type="radio" name="noise_level" value="1" id="noise_1">
                <label for="noise_1">1 Very Noisy</label><br>
                <input type="radio" name="noise_level" value="2" id="noise_2">
                <label for="noise_2">2 Noisy</label><br>
                <input type="radio" name="noise_level" value="3" id="noise_3">
                <label for="noise_3">3 Moderate</label><br>
                <input type="radio" name="noise_level" value="4" id="noise_4">
                <label for="noise_4">4 Quiet</label><br>
                <input type="radio" name="noise_level" value="5" id="noise_5">
                <label for="noise_5">5 Very Quiet</label><br><br>
                
                <label>Ear Health:</label><br>
                <input type="checkbox" id="ear_pain">
                <label for="ear_pain">I have ear pain / discomfort</label><br>
                <input type="checkbox" id="recent_cold">
                <label for="recent_cold">I had a recent cold / ear infection</label><br>
                <input type="checkbox" id="hearing_history">
                <label for="hearing_history">I have a history of hearing problems</label><br><br>
                
                <button type="submit" id="submit-login" class="btn primary">Submit and Proceed</button>
            </form>
        </div>

        <!-- Welcome Screen -->
        <div id="welcome-screen" class="hidden">
            <h1 class="title">🎧 Hearing Asymmetry Screening</h1>
            <p class="text">Welcome to the Hearing Test! 🔊<br>
            This quick demo (1-2 minutes) checks your hearing using headphones. 🎧<br>
            Ensure a quiet environment for best results. 🤫</p>
            <button id="start-btn" class="btn danger">Start Screening 🚀</button>
            <p class="text">Press SPACE or click to proceed ⌨️</p>
        </div>

        <!-- Consent Screen -->
        <div id="consent-screen" class="hidden">
            <h1 class="title warning">⚠️ Important Notice</h1>
            <p class="text">This demo is for showcase purposes only. 🩺<br>
            It is NOT a medical tool.<br><br>
            • Results are not for diagnosis<br>
            • Consult an audiologist for hearing concerns<br>
            • Ensure headphones work properly<br><br>
            By proceeding, you understand this is a demo.</p>
            <button id="agree-btn" class="btn success">I Understand - Continue ✅</button>
            <button id="back-welcome-btn" class="btn secondary">Back ⬅️</button>
        </div>

        <!-- Device Check Screen -->
        <div id="device-check-screen" class="hidden">
            <h1 class="title">🎧 Headphone Check</h1>
            <p class="text">Put on your headphones and position them correctly. 🎧<br>
            We'll play sounds to check left and right channels. 🔊</p>
            <p id="channel-status" class="text"></p>
            <button id="left-ear-btn" class="btn purple">🔊 Left Ear 👈</button>
            <button id="right-ear-btn" class="btn orange">🔊 Right Ear 👉</button>
            <button id="headphones-ready-btn" class="btn success">Headphones Ready ✓</button>
            <button id="back-consent-btn" class="btn secondary">← Back</button>
        </div>

        <!-- Calibration Screen -->
        <div id="calibration-screen" class="hidden">
            <h1 class="title">🔧 Volume Calibration</h1>
            <p class="text">We'll play a 1000 Hz tone. 🎵<br>
            Adjust volume to a comfortable level. 🔊<br>
            This is the loudest sound you'll hear.</p>
            <label class="subtitle">Volume Level: 📶</label>
            <input type="range" id="volume-slider" min="10" max="100" value="50">
            <button id="play-tone-btn" class="btn primary">🔊 Play Tone</button>
            <button id="volume-set-btn" class="btn success">Volume Set ✓</button>
            <button id="back-device-btn" class="btn secondary">← Back</button>
        </div>

        <!-- Instructions Screen -->
        <div id="instructions-screen" class="hidden">
            <h1 class="title">📝 Test Instructions</h1>
            <p class="text">Here's how it works: 🔍<br><br>
            • Hear beeps in left/right ears 👂<br>
            • Press SPACEBAR when you hear a beep 🎵<br>
            • Skip if no sound is heard 🤐<br>
            • Some trials are silent (normal) ❓<br>
            • Test adjusts to find your threshold 📉<br><br>
            Stay focused and respond quickly! ⚡</p>
            <div class="key-frame">
                <p class="subtitle warning">⌨️ Press SPACEBAR for beeps</p>
            </div>
            <button id="start-test-btn" class="btn danger">🎵 Start Test</button>
            <button id="back-calibration-btn" class="btn secondary">← Back</button>
        </div>

        <!-- Testing Screen -->
        <div id="testing-screen" class="hidden">
            <progress id="progress-bar" value="0" max="100"></progress>
            <p id="progress-label" class="text">0%</p>
            <p id="status-label" class="subtitle">Preparing test... ⚙️</p>
            <h1 id="ear-label" class="title"></h1>
            <div id="response-frame">
                <p class="subtitle warning">🎵 Press SPACEBAR for beeps</p>
                <p id="response-status" class="text secondary-text">Listen carefully... 👂</p>
            </div>
            <p id="test-info" class="text"></p>
        </div>

        <!-- Results Screen -->
        <div id="results-screen" class="hidden">
            <h1 class="title">📊 Test Results</h1>
            <canvas id="audiogram-chart"></canvas>
            <div id="result-frame">
                <p id="status-text" class="subtitle"></p>
                <p id="recommendation" class="text"></p>
            </div>
            <button id="try-again-btn" class="btn primary">🔄 Try Again</button>
            <button id="exit-btn" class="btn secondary">Exit ❌</button>
        </div>
    </div>
    <script src="/static/script.js"></script>
</body>
</html>